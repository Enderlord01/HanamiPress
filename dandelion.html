<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASCII Art con Microfono</title>
    <style>
        body {
            font-family: monospace;
            white-space: pre;
            background-color: #282c34;
            color: white;
            text-align: center;
            padding: 20px;
        }
    </style>
</head>
<body>
    <pre id="ascii-art">
      _.--'--._
    .'. ':. ' :'.
   '`' : `. `: ':' 
  : : '.'. .'.':.`:
  :' -`= `+ .= - `:
  :.' .'.' :.'.`:':
   : : .:`' .:`.':
    '.: . :`. :.'
      `'--,--'`  
          y
         ( 
          \       _
           \    /`/
     _      |__/:/_  
     \`\    |\ :  /
     _\:\_  /\ : /_
     \ : /_/\  :  /
     _\ : /_/ : /
     \  :  /.'/`
 jgs  `\ :/'/``
`^^`^`^``^^`^^^`^^`^^^`^
    </pre>

    <script>
        let isBlown = false;

        // Funzione per attivare il microfono e ascoltare il suono
        async function startListening() {
            try {
                // Richiesta per accedere al microfono
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const analyser = audioContext.createAnalyser();
                const microphone = audioContext.createMediaStreamSource(stream);
                microphone.connect(analyser);

                const bufferLength = analyser.frequencyBinCount;
                const dataArray = new Uint8Array(bufferLength);

                // Funzione per monitorare il livello del suono
                function checkSound() {
                    analyser.getByteFrequencyData(dataArray);
                    let total = 0;
                    for (let i = 0; i < bufferLength; i++) {
                        total += dataArray[i];
                    }
                    let average = total / bufferLength;

                    // Se il volume medio supera una certa soglia, cambia l'ASCII art
                    if (average > 50 && !isBlown) {
                        isBlown = true;
                        document.getElementById('ascii-art').textContent = `
                          y
                         ( 
                          \\       _
                           \\    //
                     _      |__/:/_  
                     \\\\    |\\ :  /
                     _\\:\\_  /\\ : /_
                     \\ : /_/\\  :  /
                     _\\ : /_/ : /
                     \\  :  /.'/ 
                     jgs  \\ :/'/
                     ^^^^^^^^^^^^^^^
                        `;
                    } else if (average <= 50 && isBlown) {
                        isBlown = false;
                        document.getElementById('ascii-art').textContent = `
                          _.--'--._
                        .'. ':. ' :'.
                       \`\`' : \`. \`: ':' 
                      : : '.'. .'.':.\`:
                      :' -\`= \`+ .= - \`:
                      :.' .'.' :.'.\`:':
                       : : .:\`' .:\`.':
                        '.: . :\`. :.'
                          \`'--,--'\`  
                              y
                             ( 
                              \\       _
                               \\    /\`/
                         _      |__/:/_  
                         \\\`\\    |\\ :  /
                         _\\:\\_  /\\ : /_
                         \\ : /_/\  :  /
                         _\\ : /_/ : /
                         \\  :  /.'/\`
                       jgs  \`\\ :/'/\`\`
                    \`^^\`^ \`^^\` ^^ \`^^^\` ^^`^ \`^
                        `;
                    }

                    requestAnimationFrame(checkSound);
                }

                checkSound();
            } catch (error) {
                alert('Errore nell\'accesso al microfono. Verifica le impostazioni.');
            }
        }

        startListening();
    </script>
</body>
</html>
